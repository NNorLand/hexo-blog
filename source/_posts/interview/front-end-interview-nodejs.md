---
title: 前端面试总结之NodeJS
categories:
  - interview
date: 2019-07-23 22:34:17
updated: 2019-07-23 22:34:17
tags: [NodeJs, JavaScript]
---
## koa 中间件机制

## 事件循环

[Node.js 事件循环，定时器和 process.nextTick()
](https://nodejs.org/zh-cn/docs/guides/event-loop-timers-and-nexttick/)

```

   ┌───────────────────────────┐
┌─>│           timers          │
│  └─────────────┬─────────────┘
│  ┌─────────────┴─────────────┐
│  │     pending callbacks     │
│  └─────────────┬─────────────┘
│  ┌─────────────┴─────────────┐
│  │       idle, prepare       │
│  └─────────────┬─────────────┘      ┌───────────────┐
│  ┌─────────────┴─────────────┐      │   incoming:   │
│  │           poll            │<─────┤  connections, │
│  └─────────────┬─────────────┘      │   data, etc.  │
│  ┌─────────────┴─────────────┐      └───────────────┘
│  │           check           │
│  └─────────────┬─────────────┘
│  ┌─────────────┴─────────────┐
└──┤      close callbacks      │
   └───────────────────────────┘
```

定时器：本阶段执行已经安排的 setTimeout() 和 setInterval() 的回调函数。  
待定回调：执行延迟到下一个循环迭代的 I/O 回调。  
idle, prepare：仅系统内部使用。  
轮询：检索新的 I/O 事件;执行与 I/O 相关的回调（几乎所有情况下，除了关闭的回调函数，它们由计时器和 setImmediate() 排定的之外），其余情况 node 将在此处阻塞。  
检测：setImmediate() 回调函数在这里执行。  
关闭的回调函数：一些准备关闭的回调函数，如：socket.on('close', ...)。  
